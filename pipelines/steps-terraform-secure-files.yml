 steps:
  - task: DownloadSecureFile@1
    name: "tfconfig"
    displayName: Downlaod secure ${TF_BACKEND_CONFIG_NAME} file
    inputs:
      secureFile: ${TF_BACKEND_CONFIG_NAME}

  - task: DownloadSecureFile@1
    name: "tfvars"
    displayName: 'Downlaod secure terraform.tfvars file'
    inputs:
      secureFile: terraform.tfvars

  - script: |
      cp $(tfconfig.secureFilePath) terraform/${TF_BACKEND_CONFIG_NAME}
      cp $(tfvars.secureFilePath) terraform/terraform.tfvars
    displayName: Copy secure files to terraform directory

  # Third-party task from the Marketplace
  - task: ms-devlabs.custom-terraform-tasks.custom-terraform-installer-task.TerraformInstaller@0
    displayName: Install Terraform
    inputs:
      terraformVersion: 0.12.26